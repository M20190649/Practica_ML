 synthetic observation hi line sph-simulated spiral galaxy use radiative transfer code torus produce spectral-line cube predicted hi profile global sph simulation spiral galaxy torus grids sph galaxy use adaptive mesh refinement apply ray-tracing method infer hi profile along line sight gridded galaxy observe direction enable u model observed hi profile galaxy orientation also place observer inside galaxy simulate hi observation take earth 's position milky way