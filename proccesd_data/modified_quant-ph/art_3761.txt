 resonance fluorescence band gap material direct numerical simulation non-markovian evolution numerical method calculate non-markovian evolution driven atom radiate structured continuum develop formal solution atomic reduced density matrix write markovian algorithm introduce set additional virtual density matrix follow level approximation algorithm possible trajectory photon electromagnetic field technique perturbative sense virtual density matrix require product effective memory time effective coupling strength become large number density matrix require give number timesteps per memory time technique apply problem driven two-level atom radiate close photonic band gap steady-state correlation function atom calculate