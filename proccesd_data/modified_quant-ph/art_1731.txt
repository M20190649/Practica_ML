 quantum cryptography imperfect apparatus quantum key distribution first propose bennett brassard provide possible key distribution scheme whose security depend quantum law physic far protocol prove secure even channel noise detector fault receiver vulnerable photon source use imperfect paper propose give concrete design new concept self-checking source require manufacturer photon source provide certain test test design pass source guarantee adequate security quantum key distribution protocol even though test device may build original specification main mathematical result structural theorem state state hilbert space certain epr-type equation satisfy state must essentially orthogonal sum epr pair