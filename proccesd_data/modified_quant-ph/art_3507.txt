 function-dependent phase transform quantum compute construct quantum algorithm perform function-dependent phase transform require initialization ancillary register algorithm recover initial state ancillary register regardless whether state pure mixed thus use qubits ancillary register even though entangle others occupy computational process also show algorithm optimal sense number function evaluation