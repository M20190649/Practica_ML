 single-trial estimation stimulus spike-history effect time-varying ensemble spike activity multiple neuron simulation study neuron cortical circuit exhibit coordinate spike activity produce correlate synchronous spike behavior cognition recently develop method estimate dynamic correlated ensemble activity combine model simultaneous neuronal interaction e.g. spin-glass model state-space method shimazaki et al plo comput biol e method allow u estimate stimulus-evoked dynamic neuronal interaction reproducible repeated trial identical experimental condition however method may suitable detect stimulus response neuronal dynamic exhibit significant variability across trial addition previous model include effect past spiking activity neuron current state ensemble activity study develop parametric method simultaneously estimate stimulus spike-history effect ensemble activity single-trial data even neuron exhibit dynamic largely unrelated effect goal model ensemble neuronal activity latent process include stimulus spike-history effect exogenous input latent process develop expectation-maximization algorithm simultaneously achieve estimation latent process stimulus response spike-history effect propose method useful analyze interaction internal cortical state sensory evoked activity