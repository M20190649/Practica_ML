 fast two-sample test analytic representation probability measure propose class nonparametric two-sample test cost linear sample size two test give base ensemble distance analytic function represent distribution first test use smooth empirical characteristic function represent distribution second us distribution embeddings reproducing kernel hilbert space analyticity implies difference distribution may detect almost surely finite number randomly choose location frequency new test consistent large class alternative previous linear-time test base non-smoothed empirical characteristic function much fast current state-of-the-art quadratic-time kernel-based energy distance-based test experiment artificial benchmark challenge real-world test problem demonstrate test give good power time tradeoff compete approach case good outright power even expensive quadratic-time test performance advantage retain even high dimension case difference distribution observable low order statistic