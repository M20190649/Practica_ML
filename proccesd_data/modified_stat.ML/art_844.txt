 function drive diffusion personalized counterfactual inference consider problem construct diffusion operator high dimensional data x address counterfactual function f individualized treatment effectiveness propose construct new diffusion metric k f capture local geometry x direction variance f result diffusion metric use define localized filtration f answer counterfactual question pointwise particularly situation drug trial individual patient 's outcome study long term take take medication validate model synthetic real world clinical trial create individualized notion benefit treatment