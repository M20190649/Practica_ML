 categorical reparameterization gumbel-softmax categorical variable natural choice represent discrete structure world however stochastic neural network rarely use categorical latent variable due inability backpropagate sample work present efficient gradient estimator replace non-differentiable sample categorical distribution differentiable sample novel gumbel-softmax distribution distribution essential property smoothly anneal categorical distribution show gumbel-softmax estimator outperform state-of-the-art gradient estimator structured output prediction unsupervised generative modeling task categorical latent variable enable large speedup semi-supervised classification