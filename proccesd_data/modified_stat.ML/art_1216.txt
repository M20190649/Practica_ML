 grammar variational autoencoder deep generative model wildly successful learn coherent latent representation continuous data video audio however generative modeling discrete data arithmetic expression molecular structure still pose significant challenge crucially state-of-the-art method often produce output valid make key observation frequently discrete data represent parse tree context-free grammar propose variational autoencoder encode decode directly parse tree ensure generate output always valid surprisingly show model often generate valid output also learn coherent latent space nearby point decode similar discrete output demonstrate effectiveness learn model show improved performance bayesian optimization symbolic regression molecular synthesis