 factor expectation propagation input-output fhmm model system biology consider problem joint modelling metabolic signal gene expression system biology application propose approach base input-output factorial hidden markov model propose structured variational inference approach infer structure state model start classical free form structure variational mean field approach use expectation propagation approximate expectation need variational loop show correspond factored expectation constrain approximate inference validate model extensive simulation demonstrate applicability real world bacterial data set