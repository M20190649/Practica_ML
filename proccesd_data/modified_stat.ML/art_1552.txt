 learn weighted representation generalization across design predictive model generalize well distributional shift often desirable sometimes crucial build robust reliable machine learning application focus distributional shift arise causal inference observational data unsupervised domain adaptation pose problem prediction shift design popular method overcome distributional shift make unrealistic assumption well-specified model know policy give rise observe data method hinder need pre-specified metric compare observation poor asymptotic property devise bound generalization error design shift incorporate representation learning sample re-weighting base bound propose algorithmic framework require assumption asymptotically consistent empirically study new framework use two synthetic datasets demonstrate effectiveness compare previous method