 learn metric class-conditional knn naive bayes near neighbour nbnn simple effective framework address many pitfall k-nearest neighbour knn classification yield competitive result several computer vision benchmark central tenet nn search query compare every example database ignore class information instead nn search perform within class generate score per class key problem nn technique include nbnn fail data representation capture perceptual e.g class-based similarity nbnn circumvents use independent engineer descriptor e.g sift extend applicability outside image-based domain propose learn metric capture perceptual similarity similar neighbourhood component analysis optimize differentiable form knn classification propose class conditional metric learn ccml optimize soft form nbnn selection rule typical metric learn algorithm learn either global local metric however propose method adjust particular level locality tune single parameter empirical evaluation classification retrieval task demonstrate propose method clearly outperform exist learn distance metric across variety image non-image datasets