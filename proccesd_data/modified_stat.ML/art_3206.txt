 learn efficient anomaly detector k -nn graph propose non-parametric anomaly detection algorithm high dimensional data score datapoint average k -nn distance rank accordingly train limited complexity model imitate score base max-margin learning-to-rank framework test-point declare anomaly alpha -false alarm level predict score alpha -percentile result anomaly detector show asymptotically optimal false alarm rate alpha decision region converges alpha -percentile minimum volume level set unknown underlying density addition test statistical performance computational efficiency algorithm number synthetic real-data experiment result demonstrate superiority algorithm exist k -nn base anomaly detection algorithm significant computational saving